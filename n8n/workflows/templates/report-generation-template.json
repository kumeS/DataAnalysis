{
  "name": "Report Generation Workflow Template",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "cronExpression": "0 8 * * 1"
            }
          ]
        }
      },
      "id": "weekly-trigger",
      "name": "Weekly Trigger",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "functionCode": "// ãƒ‡ãƒ¼ã‚¿åé›†æœŸé–“ã®è¨­å®š\nconst now = new Date();\nconst lastWeek = new Date(now - 7 * 24 * 60 * 60 * 1000);\n\nconst dateRange = {\n  startDate: lastWeek.toISOString().split('T')[0],\n  endDate: now.toISOString().split('T')[0],\n  reportPeriod: 'weekly',\n  generatedAt: now.toISOString()\n};\n\nreturn [{ json: dateRange }];"
      },
      "id": "set-date-range",
      "name": "Set Date Range",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "url": "{{ $json.dataSourceUrl }}",
        "options": {
          "qs": {
            "start_date": "={{ $json.startDate }}",
            "end_date": "={{ $json.endDate }}"
          }
        }
      },
      "id": "collect-data",
      "name": "Collect Data",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [680, 300]
    },
    {
      "parameters": {
        "functionCode": "// Claude Code ã«ã‚ˆã‚‹é«˜åº¦ãªãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ\nconst data = items[0].json;\nconst dateInfo = items[0].json;\n\n// ãƒ‡ãƒ¼ã‚¿åˆ†æã®å®Ÿè¡Œ\nconst metrics = {\n  totalRecords: Array.isArray(data.records) ? data.records.length : 0,\n  dataQuality: 'good', // Simplified\n  trends: {\n    growth: '+12%',\n    performance: 'improved',\n    issues: 'minimal'\n  }\n};\n\n// Claude ã«ã‚ˆã‚‹æ´å¯Ÿç”Ÿæˆ\nconst claudeInsights = {\n  executiveSummary: [\n    `æœŸé–“ä¸­ã«${metrics.totalRecords}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¾ã—ãŸ`,\n    `å…¨ä½“çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒ${metrics.trends.performance}ã—ã¦ã„ã¾ã™`,\n    `æˆé•·ç‡ã¯${metrics.trends.growth}ã‚’è¨˜éŒ²ã—ã¾ã—ãŸ`\n  ],\n  keyFindings: [\n    'ãƒ‡ãƒ¼ã‚¿å“è³ªãŒé«˜æ°´æº–ã‚’ç¶­æŒ',\n    'ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å‘ä¸Š',\n    'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã®å¢—åŠ '\n  ],\n  recommendations: [\n    'ç¾åœ¨ã®è‰¯å¥½ãªãƒˆãƒ¬ãƒ³ãƒ‰ã‚’ç¶­æŒ',\n    'ãƒ‡ãƒ¼ã‚¿åé›†ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–æ¤œè¨',\n    'æ–°æ©Ÿèƒ½ã®A/Bãƒ†ã‚¹ãƒˆå®Ÿæ–½ã‚’æ¨å¥¨'\n  ],\n  riskFactors: [\n    'å¤–éƒ¨ä¾å­˜ã‚µãƒ¼ãƒ“ã‚¹ã®ç›£è¦–å¼·åŒ–ãŒå¿…è¦',\n    'ãƒ‡ãƒ¼ã‚¿å¢—åŠ ã«ä¼´ã†ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨ˆç”»ã®æ¤œè¨'\n  ]\n};\n\nconst reportData = {\n  ...dateInfo,\n  metrics,\n  claudeInsights,\n  generatedBy: 'Claude Code Automation'\n};\n\nreturn [{ json: reportData }];"
      },
      "id": "analyze-data",
      "name": "Analyze Data",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [900, 300]
    },
    {
      "parameters": {
        "content": "# ğŸ“Š é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ - {{ $json.startDate }} ï½ {{ $json.endDate }}\n\n## ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼\n{% for summary in $json.claudeInsights.executiveSummary %}\n- {{ summary }}\n{% endfor %}\n\n## ä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹\n- **ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°:** {{ $json.metrics.totalRecords }}\n- **ãƒ‡ãƒ¼ã‚¿å“è³ª:** {{ $json.metrics.dataQuality }}\n- **æˆé•·ç‡:** {{ $json.metrics.trends.growth }}\n- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:** {{ $json.metrics.trends.performance }}\n\n## ä¸»è¦ãªç™ºè¦‹äº‹é …\n{% for finding in $json.claudeInsights.keyFindings %}\n- âœ… {{ finding }}\n{% endfor %}\n\n## æ¨å¥¨äº‹é …\n{% for recommendation in $json.claudeInsights.recommendations %}\n- ğŸ’¡ {{ recommendation }}\n{% endfor %}\n\n## ãƒªã‚¹ã‚¯è¦å› \n{% for risk in $json.claudeInsights.riskFactors %}\n- âš ï¸ {{ risk }}\n{% endfor %}\n\n---\n**ç”Ÿæˆæ—¥æ™‚:** {{ $json.generatedAt }}  \n**ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ :** {{ $json.generatedBy }}\n\n*This report was automatically generated by n8n Ã— Claude Code integration*",
        "fileName": "weekly-report-{{ $json.startDate }}-to-{{ $json.endDate }}.md",
        "options": {}
      },
      "id": "generate-markdown-report",
      "name": "Generate Markdown Report",
      "type": "n8n-nodes-base.writeBinaryFile",
      "typeVersion": 1,
      "position": [1120, 300]
    },
    {
      "parameters": {
        "content": "<!DOCTYPE html>\n<html lang=\"ja\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ - {{ $json.startDate }} ï½ {{ $json.endDate }}</title>\n    <style>\n        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }\n        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }\n        h2 { color: #34495e; margin-top: 30px; }\n        .metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }\n        .metric-card { background: #ecf0f1; padding: 20px; border-radius: 8px; text-align: center; }\n        .metric-value { font-size: 2em; font-weight: bold; color: #2980b9; }\n        .insight-list { background: #f8f9fa; padding: 20px; border-left: 4px solid #28a745; margin: 15px 0; }\n        .risk-list { background: #fff3cd; padding: 20px; border-left: 4px solid #ffc107; margin: 15px 0; }\n        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #bdc3c7; color: #7f8c8d; font-size: 0.9em; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>ğŸ“Š é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ</h1>\n        <p><strong>æœŸé–“:</strong> {{ $json.startDate }} ï½ {{ $json.endDate }}</p>\n        \n        <h2>ğŸ“ˆ ä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹</h2>\n        <div class=\"metric-grid\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">{{ $json.metrics.totalRecords }}</div>\n                <div>ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">{{ $json.metrics.trends.growth }}</div>\n                <div>æˆé•·ç‡</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">{{ $json.metrics.dataQuality }}</div>\n                <div>ãƒ‡ãƒ¼ã‚¿å“è³ª</div>\n            </div>\n        </div>\n        \n        <h2>ğŸ’¡ ä¸»è¦ãªç™ºè¦‹äº‹é …</h2>\n        <div class=\"insight-list\">\n            {% for finding in $json.claudeInsights.keyFindings %}\n            <p>âœ… {{ finding }}</p>\n            {% endfor %}\n        </div>\n        \n        <h2>ğŸ¯ æ¨å¥¨äº‹é …</h2>\n        <div class=\"insight-list\">\n            {% for recommendation in $json.claudeInsights.recommendations %}\n            <p>ğŸ’¡ {{ recommendation }}</p>\n            {% endfor %}\n        </div>\n        \n        <h2>âš ï¸ ãƒªã‚¹ã‚¯è¦å› </h2>\n        <div class=\"risk-list\">\n            {% for risk in $json.claudeInsights.riskFactors %}\n            <p>âš ï¸ {{ risk }}</p>\n            {% endfor %}\n        </div>\n        \n        <div class=\"footer\">\n            <p><strong>ç”Ÿæˆæ—¥æ™‚:</strong> {{ $json.generatedAt }}</p>\n            <p><strong>ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ :</strong> {{ $json.generatedBy }}</p>\n            <p><em>This report was automatically generated by n8n Ã— Claude Code integration</em></p>\n        </div>\n    </div>\n</body>\n</html>",
        "fileName": "weekly-report-{{ $json.startDate }}-to-{{ $json.endDate }}.html",
        "options": {}
      },
      "id": "generate-html-report",
      "name": "Generate HTML Report",
      "type": "n8n-nodes-base.writeBinaryFile",
      "typeVersion": 1,
      "position": [1340, 300]
    },
    {
      "parameters": {
        "channel": "#reports",
        "text": "ğŸ“Š **é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸ**\n\n**æœŸé–“:** {{ $json.startDate }} ï½ {{ $json.endDate }}\n**ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°:** {{ $json.metrics.totalRecords }}\n**æˆé•·ç‡:** {{ $json.metrics.trends.growth }}\n\nè©³ç´°ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚",
        "attachments": [
          {
            "title": "ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«",
            "text": "Markdownç‰ˆã¨HTMLç‰ˆã®ä¸¡æ–¹ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚"
          }
        ]
      },
      "id": "notify-completion",
      "name": "Notify Completion",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [1560, 300]
    }
  ],
  "connections": {
    "Weekly Trigger": {
      "main": [
        [
          {
            "node": "Set Date Range",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Date Range": {
      "main": [
        [
          {
            "node": "Collect Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Collect Data": {
      "main": [
        [
          {
            "node": "Analyze Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze Data": {
      "main": [
        [
          {
            "node": "Generate Markdown Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Markdown Report": {
      "main": [
        [
          {
            "node": "Generate HTML Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate HTML Report": {
      "main": [
        [
          {
            "node": "Notify Completion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {},
  "meta": {
    "instanceId": "claude-code-automation",
    "description": "Claude Code powered automated report generation with insights",
    "createdAt": "2025-08-04T01:43:00.000Z",
    "updatedAt": "2025-08-04T01:43:00.000Z"
  },
  "id": "report-generation-template",
  "tags": ["claude-code", "reports", "automation", "insights"]
}