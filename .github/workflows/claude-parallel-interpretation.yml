name: Claude Parallel Metabolomics Interpretation

on:
  push:
    paths:
      - 'results/parallel-metabolomics-analysis/**'
    branches:
      - main

jobs:
  claude-parallel-interpretation:
    if: contains(github.event.head_commit.message, 'Generated by Claude Â· Parallel Metabolomics Analysis workflow')
    runs-on: ubuntu-latest
    permissions:
      contents: write
      issues: write
      pull-requests: write
      id-token: write
      actions: read

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Generate Claude AI Interpretation for Parallel Analysis
        uses: anthropics/claude-code-action@beta
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          direct_prompt: |
            I have committed new parallel metabolomics analysis results to the repository. Please analyze these comprehensive results and provide scientific interpretation.
            
            This analysis used three parallel components executed simultaneously:
            1. **EDA (Exploratory Data Analysis)** - PCA, correlation analysis, basic statistics
            2. **Modeling** - Statistical modeling and hypothesis testing
            3. **Visualization** - Advanced data visualization and heatmaps
            
            The analysis files are located in the latest `results/parallel-metabolomics-analysis/` directory and include:
            - FINAL_REPORT.md (integrated report from all components)
            - README.md (analysis summary)
            - eda-outputs/ (exploratory analysis results and visualizations)
            - modeling-outputs/ (statistical modeling results)
            - viz-outputs/ (visualization analysis outputs)
            
            Please examine these files and provide comprehensive interpretation covering:
            
            ## 1. Executive Summary
            - Overview of parallel analysis approach
            - Key findings across all analysis components
            - Integration of insights from EDA, modeling, and visualization
            
            ## 2. Component-Specific Analysis
            - **EDA Insights**: Patterns discovered through exploratory analysis
            - **Modeling Results**: Statistical findings and significance
            - **Visualization Insights**: Pattern recognition from visual analysis
            
            ## 3. Statistical Analysis & Group Comparisons
            - **Variance Analysis**: Assess within-group and between-group variance patterns
            - **Distribution Analysis**: Examine metabolite concentration distributions and normality
            - **Group Comparisons**: Identify significant differences between metabolic states/conditions
            - **Effect Size Assessment**: Quantify magnitude of observed differences
            - **Statistical Power**: Evaluate adequacy of sample sizes for detected effects
            - **Multiple Testing Corrections**: Account for multiple comparisons in metabolite analysis
            
            ## 4. Integrated Biological Interpretation
            - Metabolic pathway implications from combined analysis
            - Fasting state metabolic profile insights
            - Cross-component validation of findings
            - Potential biomarkers identified through multiple approaches
            - **Metabolic Network Analysis**: Interconnections between identified metabolites
            - **Pathway Enrichment**: Overrepresentation of specific metabolic pathways
            
            ## 5. Statistical Validation & Robustness
            - Cross-validation between analysis components
            - Statistical significance assessment with confidence intervals
            - Data quality evaluation across all components
            - **Sensitivity Analysis**: Robustness of findings to analytical choices
            - **Bootstrap Analysis**: Stability of statistical estimates
            - **Outlier Impact Assessment**: Effect of extreme values on conclusions
            
            ## 6. Discussion & Critical Considerations
            - **Biological Plausibility**: Are findings consistent with known metabolic physiology?
            - **Clinical Relevance**: How do statistical findings translate to practical significance?
            - **Methodological Limitations**: What are the constraints of the analytical approach?
            - **Confounding Factors**: What variables might influence the observed patterns?
            - **Reproducibility Considerations**: How likely are findings to replicate?
            - **Sample Representativeness**: Do results generalize beyond the current dataset?
            
            ## 7. Clinical and Research Implications
            - Health implications of integrated findings with statistical context
            - Diagnostic potential of identified patterns with performance metrics
            - Research applications and future directions
            - **Biomarker Validation Requirements**: Steps needed for clinical translation
            - **Therapeutic Target Assessment**: Potential intervention points identified
            
            ## 8. Methodological Assessment
            - Benefits of parallel analysis approach
            - Computational efficiency gains
            - Analytical robustness and validation
            - **Statistical Method Appropriateness**: Suitability of chosen analytical techniques
            - **Data Quality Impact**: How data characteristics affect interpretation
            
            ## 9. Actionable Recommendations
            - Immediate steps for result utilization with statistical priorities
            - Future analysis suggestions including power calculations
            - Data integration opportunities
            - **Validation Study Design**: Recommendations for confirming findings
            - **Sample Size Considerations**: Requirements for follow-up studies
            
            Focus on integrating insights from all three parallel components and highlight the advantages 
            of the multi-component approach. Create both:
            1. A comprehensive markdown file called 'claude_parallel_interpretation.md'
            2. An HTML report called 'claude_parallel_interpretation.html' formatted for GitHub Pages viewing
            
            The HTML report should include:
            - Professional styling with CSS
            - Interactive elements where appropriate
            - Proper formatting for web viewing
            - Embedded images and visualizations
            - Table of contents with navigation
            - Responsive design for different screen sizes
            - Integration dashboard showing results from all three components
            
            Save both files in the same results directory with your comprehensive analysis.
            
            After creating the interpretation files, commit them to the repository with an appropriate commit message.